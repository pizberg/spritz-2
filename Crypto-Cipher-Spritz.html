<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Crypto.Cipher.Spritz</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Crypto-Cipher-Spritz.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">spritz-0.1.0.0: An implementation of the Spritz RC4-like stream cipher in Haskell</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>(C) 2014 Ricky Elrod</td></tr><tr><th>License</th><td>BSD2 (see LICENSE file)</td></tr><tr><th>Maintainer</th><td>Ricky Elrod &lt;ricky@elrod.me&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>lens</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Crypto.Cipher.Spritz</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">State/Lenses</a></li><li><a href="#g:2">Spritz basic functions</a></li><li><a href="#g:3">Helper functions</a></li><li><a href="#g:4">Making use of everything</a><ul><li><a href="#g:5">Encyrption</a></li><li><a href="#g:6">Hashing</a></li><li><a href="#g:7">Message Authentication Code (MAC)</a></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The original paper for the Spritz cipher can be found here:</p><p><a href="https://people.csail.mit.edu/rivest/pubs/RS14.pdf">https://people.csail.mit.edu/rivest/pubs/RS14.pdf</a></p><p>This package provides a Haskell implementation of the pseudocode in the paper
 listed above. It intends to be a direct implementation of the cipher, so we
 rely heavily on use of the State monad. We also make heavy use of the lens
 library's combinators, internally, to ease our use of State.</p><p>Lastly, I must give a shout-out to
 <a href="https://github.com/therealjampers/spritzjs">spritzjs</a> for the bitmasking
 parts and for existing so that I had something to test against when I was
 done.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:SpritzState">SpritzState</a> = <a href="#v:SpritzState">SpritzState</a> {<ul class="subs"><li><a href="#v:_i">_i</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li><a href="#v:_j">_j</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li><a href="#v:_k">_k</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li><a href="#v:_z">_z</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li><a href="#v:_w">_w</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li><a href="#v:_a">_a</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li><a href="#v:_s">_s</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li><a href="#v:_n">_n</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li></ul>}</li><li class="src short"><a href="#v:i">i</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:j">j</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:k">k</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:z">z</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:w">w</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:a">a</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:s">s</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> (Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a>)</li><li class="src short"><a href="#v:n">n</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:initializeState">initializeState</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></li><li class="src short"><a href="#v:absorb">absorb</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:absorbByte">absorbByte</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:absorbNibble">absorbNibble</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:absorbStop">absorbStop</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:shuffle">shuffle</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:whip">whip</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:crush">crush</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:squeeze">squeeze</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> (Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a>)</li><li class="src short"><a href="#v:drip">drip</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:update">update</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:output">output</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:low">low</a> :: (<a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Bits.html#t:Bits">Bits</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Num">Num</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Text-Show.html#t:Show">Show</a> a) =&gt; a -&gt; a</li><li class="src short"><a href="#v:high">high</a> :: (<a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Bits.html#t:Bits">Bits</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Num">Num</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Text-Show.html#t:Show">Show</a> a) =&gt; a -&gt; a</li><li class="src short"><a href="#v:plusmod">plusmod</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; a -&gt; a -&gt; a</li><li class="src short"><a href="#v:submod">submod</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; a -&gt; a -&gt; a</li><li class="src short"><a href="#v:swap">swap</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:encrypt">encrypt</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:decrypt">decrypt</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:keySetup">keySetup</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</li><li class="src short"><a href="#v:hash">hash</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:mac">mac</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> -&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></li></ul></div><div id="interface"><h1 id="g:1">State/Lenses</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:SpritzState" class="def">SpritzState</a></p><div class="doc"><p>Register values and <code><a href="Crypto-Cipher-Spritz.html#v:s">s</a></code>. As a <strong>difference to the paper</strong>, we also include
 <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code> in the state, for easy access to it within the various functions.</p><p>See &#167;3.1 <a href="State.html">State</a>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SpritzState" class="def">SpritzState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:_i" class="def">_i</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Register: Always incremented by <code><code><a href="Crypto-Cipher-Spritz.html#v:w">w</a></code> `'mod'` <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code></code>
 whenever changed.</p></dd><dt class="src"><a name="v:_j" class="def">_j</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Register</p></dd><dt class="src"><a name="v:_k" class="def">_k</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Register</p></dd><dt class="src"><a name="v:_z" class="def">_z</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Register: Last value produced by <code><a href="Crypto-Cipher-Spritz.html#v:output">output</a></code></p></dd><dt class="src"><a name="v:_w" class="def">_w</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Register: Modified when <code><a href="Crypto-Cipher-Spritz.html#v:whip">whip</a></code> is called. Always
 relatively prime to <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code>.</p></dd><dt class="src"><a name="v:_a" class="def">_a</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Register: Number of nibbles absorbed since start of last
 <code><a href="Crypto-Cipher-Spritz.html#v:shuffle">shuffle</a></code> of <code><a href="Crypto-Cipher-Spritz.html#v:s">s</a></code>.</p></dd><dt class="src"><a name="v:_s" class="def">_s</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Length <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code>. Permutation of Z_n.</p></dd><dt class="src"><a name="v:_n" class="def">_n</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>All values in Spritz are modulo <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code>.</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:SpritzState" class="caption collapser" onclick="toggleSection('i:SpritzState')">Instances</p><div id="section.i:SpritzState" class="show"><table><tr><td class="src"><a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Eq.html#t:Eq">Eq</a> <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Ord.html#t:Ord">Ord</a> <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///usr/share/doc/ghc/html/libraries/base/Text-Show.html#t:Show">Show</a> <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:i" class="def">i</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><div class="top"><p class="src"><a name="v:j" class="def">j</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><div class="top"><p class="src"><a name="v:k" class="def">k</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><div class="top"><p class="src"><a name="v:z" class="def">z</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><div class="top"><p class="src"><a name="v:w" class="def">w</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><div class="top"><p class="src"><a name="v:a" class="def">a</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><div class="top"><p class="src"><a name="v:s" class="def">s</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> (Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a>)</p></div><div class="top"><p class="src"><a name="v:n" class="def">n</a> :: Lens' <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><h1 id="g:2">Spritz basic functions</h1><div class="top"><p class="src"><a name="v:initializeState" class="def">initializeState</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code> value to use throughout.</p></td></tr><tr><td class="src">-&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc"><p>The initial state.</p></td></tr></table></div><div class="doc"><p>Returns the standard initial state. See &#167;3.2 <a href="InitializeState.html">InitializeState</a>.</p></div></div><div class="top"><p class="src"><a name="v:absorb" class="def">absorb</a> :: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p><div class="doc"><p>Takes a variable-lenght input and updates the state based on it. Spritz
 absorbs input in blocks of <code><code><a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#v:floor">floor</a></code> (<code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code> / 2)</code> nibbles each (low-order
 nibble of each byte first). After each block is absorbed, we call <code><a href="Crypto-Cipher-Spritz.html#v:shuffle">shuffle</a></code>.</p><p>Satisfies the following law:</p><pre><code><a href="Crypto-Cipher-Spritz.html#v:absorb">absorb</a></code> x1 &gt;&gt; <code><a href="Crypto-Cipher-Spritz.html#v:absorb">absorb</a></code> x2 = 'absorb (x1 ++ x2)'</pre><p>See &#167;3.2 <a href="Absorb.html">Absorb</a>.</p></div></div><div class="top"><p class="src"><a name="v:absorbByte" class="def">absorbByte</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p><div class="doc"><p>Splits the given input byte into two nibbles and updates state based on
 each nibble, low-order nibble first. See &#167;3.2 <a href="AbsorbByte.html">AbsorbByte</a>.</p></div></div><div class="top"><p class="src"><a name="v:absorbNibble" class="def">absorbNibble</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p><div class="doc"><p>TODO: Write documentation. See &#167;3.2 <a href="AbsorbNibble.html">AbsorbNibble</a>.</p></div></div><div class="top"><p class="src"><a name="v:absorbStop" class="def">absorbStop</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p><div class="doc"><p>Equivalent to absorbing a special &quot;stop&quot; symbol outside of the oridnary
 input alphabet. The intent is to provide a clean way to separate different
 inputs being absorbed. See &#167;2.1.</p></div></div><div class="top"><p class="src"><a name="v:shuffle" class="def">shuffle</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p><div class="doc"><p><code><a href="Crypto-Cipher-Spritz.html#v:whip">whip</a></code>s, <code><a href="Crypto-Cipher-Spritz.html#v:crush">crush</a></code>es, <code><a href="Crypto-Cipher-Spritz.html#v:whip">whip</a></code>s, <code><a href="Crypto-Cipher-Spritz.html#v:crush">crush</a></code>es, and finally <code><a href="Crypto-Cipher-Spritz.html#v:whip">whip</a></code>s again.
 According to the paper, each <code><a href="Crypto-Cipher-Spritz.html#v:whip">whip</a></code> randomizes the state. Calling <code><a href="Crypto-Cipher-Spritz.html#v:crush">crush</a></code>
 between each <code><a href="Crypto-Cipher-Spritz.html#v:whip">whip</a></code> causes the effects of <code><a href="Crypto-Cipher-Spritz.html#v:crush">crush</a></code> to be not easily determined
 by manipulating the input.  See &#167;3.2 <a href="Shuffle.html">Shuffle</a>.</p></div></div><div class="top"><p class="src"><a name="v:whip" class="def">whip</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p><code>r</code>. The number of times to call <code><a href="Crypto-Cipher-Spritz.html#v:update">update</a></code>.</p></td></tr><tr><td class="src">-&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Calls <code><a href="Crypto-Cipher-Spritz.html#v:update">update</a></code> <code>r</code> times. Also updates <code><a href="Crypto-Cipher-Spritz.html#v:w">w</a></code> to the next largest value that
 is relatively prime to <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:crush" class="def">crush</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p></div><div class="top"><p class="src"><a name="v:squeeze" class="def">squeeze</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> (Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a>)</p></div><div class="top"><p class="src"><a name="v:drip" class="def">drip</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><div class="top"><p class="src"><a name="v:update" class="def">update</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p></div><div class="top"><p class="src"><a name="v:output" class="def">output</a> :: State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></p></div><h1 id="g:3">Helper functions</h1><div class="top"><p class="src"><a name="v:low" class="def">low</a> :: (<a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Bits.html#t:Bits">Bits</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Num">Num</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Text-Show.html#t:Show">Show</a> a) =&gt; a -&gt; a</p></div><div class="top"><p class="src"><a name="v:high" class="def">high</a> :: (<a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Bits.html#t:Bits">Bits</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Num">Num</a> a, <a href="file:///usr/share/doc/ghc/html/libraries/base/Text-Show.html#t:Show">Show</a> a) =&gt; a -&gt; a</p></div><div class="top"><p class="src"><a name="v:plusmod" class="def">plusmod</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; a -&gt; a -&gt; a</p><div class="doc"><p>A utility function that adds the first parameter to the second then returns
 that modulo the third parameter (<code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code>). This is used throughout Spritz in
 place of a more traditional <code><a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Bits.html#v:xor">xor</a></code> approach so that <code><a href="Crypto-Cipher-Spritz.html#v:n">n</a></code> can be any value and
 is not limited to being a power of 2.</p></div></div><div class="top"><p class="src"><a name="v:submod" class="def">submod</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; a -&gt; a -&gt; a</p><div class="doc"><p>See <code><a href="Crypto-Cipher-Spritz.html#v:plusmod">plusmod</a></code>. This is very similar except it subtracts the first two
 arguments instead of adding them.</p></div></div><div class="top"><p class="src"><a name="v:swap" class="def">swap</a> :: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a> -&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</p><div class="doc"><p>Swap two elements given indices of S.</p></div></div><h1 id="g:4">Making use of everything</h1><h2 id="g:5">Encyrption</h2><div class="top"><p class="src"><a name="v:encrypt" class="def">encrypt</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The key.</p></td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The decrypted message.</p></td></tr><tr><td class="src">-&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc"><p>Starting state.</p></td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Adds-modulo-N (<code><a href="Crypto-Cipher-Spritz.html#v:plusmod">plusmod</a></code>) each byte of the message with the corresponding
 byte of the output of <code><a href="Crypto-Cipher-Spritz.html#v:squeeze">squeeze</a></code> yielding an ecrypted ciphertext. See &#167;2.2.</p></div></div><div class="top"><p class="src"><a name="v:decrypt" class="def">decrypt</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The key.</p></td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The encrypted message.</p></td></tr><tr><td class="src">-&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc"><p>Starting state.</p></td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Decrypts a message encrypted with <code><a href="Crypto-Cipher-Spritz.html#v:encrypt">encrypt</a></code>. Identical to <code><a href="Crypto-Cipher-Spritz.html#v:encrypt">encrypt</a></code> except
 uses <code><a href="Crypto-Cipher-Spritz.html#v:submod">submod</a></code> instead. See &#167;2.2.</p></div></div><div class="top"><p class="src"><a name="v:keySetup" class="def">keySetup</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Our N value. 256 in the paper.</p></td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The key.</p></td></tr><tr><td class="src">-&gt; State <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Used in the paper at the top of <code><a href="Crypto-Cipher-Spritz.html#v:encrypt">encrypt</a></code>* and <code><a href="Crypto-Cipher-Spritz.html#v:decrypt">decrypt</a></code>, but not used by
 default in this library. Still, we provide it in case it's needed.</p><pre>keySetup n' k' = put (initializeState n') &gt;&gt; absorb k'</pre></div></div><h2 id="g:6">Hashing</h2><div class="top"><p class="src"><a name="v:hash" class="def">hash</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The message.</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>r (number of bytes).</p></td></tr><tr><td class="src">-&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc"><p>Initial state.</p></td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Produces an <code>r</code>-byte hash of the input message.</p><p><code><a href="Crypto-Cipher-Spritz.html#v:hash">hash</a></code> absorbs the input message, calls <code><a href="Crypto-Cipher-Spritz.html#v:absorbStop">absorbStop</a></code> to signal the end of the
 input message, then absorbs the desired hash length (<code>r</code>).</p><p>The given <code>r</code> is absorbed for functional separation.</p><p>See &#167; 2.3.</p></div></div><h2 id="g:7">Message Authentication Code (MAC)</h2><div class="top"><p class="src"><a name="v:mac" class="def">mac</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The key.</p></td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The message.</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>r</p></td></tr><tr><td class="src">-&gt; <a href="Crypto-Cipher-Spritz.html#t:SpritzState">SpritzState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Vector <a href="file:///usr/share/doc/ghc/html/libraries/base/Data-Int.html#t:Int">Int</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Message authentication code. See &#167;2.4.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.14.3</p></div></body></html>